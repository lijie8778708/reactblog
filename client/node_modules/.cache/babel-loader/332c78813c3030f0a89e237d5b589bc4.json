{"ast":null,"code":"import React from 'react';\nimport axios from 'axios';\nimport { LOGIN_SUCCESS, USER_LOADED, AUTH_ERROR, LOGOUT } from './types';\nimport setAuthToken from '../utils/setAuthToken';\nexport const loadUser = () => async dispatch => {\n  if (localStorage.getItem(\"token\")) {\n    setAuthToken(localStorage.getItem(\"token\"));\n  }\n\n  console.log(localStorage.getItem(\"token\"));\n\n  try {\n    const res = await axios.get(\"/auth\");\n    dispatch({\n      type: USER_LOADED,\n      payload: res.data.data\n    });\n  } catch (err) {\n    dispatch({\n      type: AUTH_ERROR\n    });\n  }\n};\nexport const login = ({\n  username,\n  password\n}) => async dispatch => {\n  try {\n    const res = await axios.post(\"/login\", {\n      username: username,\n      password: password\n    });\n    JSON.stringify(res);\n    console.log(res.data.data.token);\n    dispatch({\n      type: LOGIN_SUCCESS,\n      payload: res.data\n    });\n    dispatch(loadUser());\n  } catch (err) {\n    dispatch({\n      type: LOGIN_FAIL,\n      payload: null\n    });\n  }\n};\nexport const logout = () => async dispatch => {\n  //dispatch({ type: CLEAR_PROFILE });\n  try {\n    await axios.get(\"logout\");\n  } catch (err) {}\n\n  dispatch({\n    type: LOGOUT\n  });\n};","map":{"version":3,"sources":["/Users/jieli/Desktop/reactblog/client/src/actions/auth.js"],"names":["React","axios","LOGIN_SUCCESS","USER_LOADED","AUTH_ERROR","LOGOUT","setAuthToken","loadUser","dispatch","localStorage","getItem","console","log","res","get","type","payload","data","err","login","username","password","post","JSON","stringify","token","LOGIN_FAIL","logout"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,aAAT,EAAwBC,WAAxB,EAAqCC,UAArC,EAAiDC,MAAjD,QAA+D,SAA/D;AACA,OAAOC,YAAP,MAAyB,uBAAzB;AAEA,OAAO,MAAMC,QAAQ,GAAG,MAAM,MAAMC,QAAN,IAAkB;AAC5C,MAAIC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAJ,EAAmC;AAC/BJ,IAAAA,YAAY,CAACG,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAZ;AACH;;AACDC,EAAAA,OAAO,CAACC,GAAR,CAAYH,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAZ;;AAEA,MAAI;AACA,UAAMG,GAAG,GAAG,MAAMZ,KAAK,CAACa,GAAN,CAAU,OAAV,CAAlB;AAEAN,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEZ,WADD;AAELa,MAAAA,OAAO,EAAEH,GAAG,CAACI,IAAJ,CAASA;AAFb,KAAD,CAAR;AAIH,GAPD,CAOE,OAAOC,GAAP,EAAY;AACVV,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEX;AADD,KAAD,CAAR;AAGH;AACJ,CAlBM;AAoBP,OAAO,MAAMe,KAAK,GAAG,CAAC;AAAEC,EAAAA,QAAF;AAAYC,EAAAA;AAAZ,CAAD,KAA4B,MAAMb,QAAN,IAAkB;AAE/D,MAAI;AACA,UAAMK,GAAG,GAAG,MAAMZ,KAAK,CAACqB,IAAN,CAAW,QAAX,EAAqB;AACnCF,MAAAA,QAAQ,EAAEA,QADyB;AAEnCC,MAAAA,QAAQ,EAAEA;AAFyB,KAArB,CAAlB;AAIAE,IAAAA,IAAI,CAACC,SAAL,CAAeX,GAAf;AACAF,IAAAA,OAAO,CAACC,GAAR,CAAYC,GAAG,CAACI,IAAJ,CAASA,IAAT,CAAcQ,KAA1B;AAEAjB,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEb,aADD;AAELc,MAAAA,OAAO,EAAEH,GAAG,CAACI;AAFR,KAAD,CAAR;AAIAT,IAAAA,QAAQ,CAACD,QAAQ,EAAT,CAAR;AACH,GAbD,CAaE,OAAOW,GAAP,EAAY;AACVV,IAAAA,QAAQ,CAAC;AACLO,MAAAA,IAAI,EAAEW,UADD;AAELV,MAAAA,OAAO,EAAE;AAFJ,KAAD,CAAR;AAIH;AACJ,CArBM;AAuBP,OAAO,MAAMW,MAAM,GAAG,MAAM,MAAMnB,QAAN,IAAkB;AAC1C;AACA,MAAI;AACA,UAAMP,KAAK,CAACa,GAAN,CAAU,QAAV,CAAN;AACH,GAFD,CAEE,OAAOI,GAAP,EAAY,CAEb;;AACDV,EAAAA,QAAQ,CAAC;AACLO,IAAAA,IAAI,EAAEV;AADD,GAAD,CAAR;AAGH,CAVM","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { LOGIN_SUCCESS, USER_LOADED, AUTH_ERROR, LOGOUT } from './types';\nimport setAuthToken from '../utils/setAuthToken';\n\nexport const loadUser = () => async dispatch => {\n    if (localStorage.getItem(\"token\")) {\n        setAuthToken(localStorage.getItem(\"token\"));\n    }\n    console.log(localStorage.getItem(\"token\"));\n\n    try {\n        const res = await axios.get(\"/auth\");\n\n        dispatch({\n            type: USER_LOADED,\n            payload: res.data.data\n        });\n    } catch (err) {\n        dispatch({\n            type: AUTH_ERROR\n        })\n    }\n}\n\nexport const login = ({ username, password }) => async dispatch => {\n\n    try {\n        const res = await axios.post(\"/login\", {\n            username: username,\n            password: password\n        })\n        JSON.stringify(res)\n        console.log(res.data.data.token);\n\n        dispatch({\n            type: LOGIN_SUCCESS,\n            payload: res.data\n        })\n        dispatch(loadUser());\n    } catch (err) {\n        dispatch({\n            type: LOGIN_FAIL,\n            payload: null\n        })\n    }\n}\n\nexport const logout = () => async dispatch => {\n    //dispatch({ type: CLEAR_PROFILE });\n    try {\n        await axios.get(\"logout\")\n    } catch (err) {\n\n    }\n    dispatch({\n        type: LOGOUT\n    });\n};"]},"metadata":{},"sourceType":"module"}